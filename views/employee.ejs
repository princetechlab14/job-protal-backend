<!DOCTYPE html>
<html lang="en">
  <%- include("./partial/head",{title:title}) %>

  <body
    class="bg-gray-100 dark:bg-gray-900 font-sans bg-cover bg-center"
    style="background-image: url('your-image-url.jpg')"
  >
    <!-- Sidebar -->
    <%- include("./partial/sidebar") %>
    <!-- Main Content -->
    <div class="ml-0 md:ml-64 flex flex-col min-h-screen">
      <!-- Header -->
      <%- include("./partial/header") %>
      <!-- Main Content Area -->
      <div class="container mx-auto py-8 mt-5">
        <div class="flex flex-col shadow-md mb-5 bg-white rounded-lg p-5">
          <h1
            class="text-4xl font-extrabold mb-4 text-gray-900 dark:text-white"
          >
            Employee List
          </h1>
          <nav class="flex mb-4" aria-label="Breadcrumb">
            <ol class="inline-flex items-center space-x-1 md:space-x-3">
              <li class="inline-flex items-center">
                <a
                  href="/admin/dashboard"
                  class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white"
                >
                  <svg
                    class="w-4 h-4 mr-2"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M10 3.172L17.071 10.243 16.364 10.95 10 4.586 3.636 10.95 2.929 10.243 10 3.172z"
                    ></path>
                  </svg>
                  Home
                </a>
              </li>

              <li aria-current="page">
                <div class="flex items-center">
                  <svg
                    class="w-6 h-6 text-gray-400"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M10 3.172l7.071 7.071-1.414 1.414L10 4.586l-5.657 5.657-1.414-1.414L10 3.172z"
                    ></path>
                  </svg>
                  <span
                    class="ml-1 text-sm font-medium text-gray-500 md:ml-2 dark:text-gray-400"
                    >Employee List</span
                  >
                </div>
              </li>
            </ol>
          </nav>
        </div>
        <div
          class="container shadow-lg bg-white rounded-lg mx-auto px-4 sm:px-8"
        >
          <div class="py-8">
            <div class="overflow-x-auto">
              <table
                id="employeeTable"
                class="min-w-full bg-white border border-gray-200 rounded-lg"
              >
                <thead style="background-color: #1f2937">
                  <tr>
                    <th
                      class="px-4 py-3 text-left text-xs font-medium text-gray-100 uppercase tracking-wider"
                    >
                      ID
                    </th>
                    <th
                      class="px-4 py-3 text-left text-xs font-medium text-gray-100 uppercase tracking-wider"
                    >
                      First Name
                    </th>
                    <th
                      class="px-4 py-3 text-left text-xs font-medium text-gray-100 uppercase tracking-wider"
                    >
                      Last Name
                    </th>
                    <th
                      class="px-4 py-3 text-left text-xs font-medium text-gray-100 uppercase tracking-wider"
                    >
                      Email
                    </th>
                    <th
                      class="px-4 py-3 text-left text-xs font-medium text-gray-100 uppercase tracking-wider"
                    >
                      Phone Number
                    </th>
                    <th
                      class="px-4 py-3 text-left text-xs font-medium text-gray-100 uppercase tracking-wider"
                    >
                      City
                    </th>
                    <th
                      class="px-4 py-3 text-left text-xs font-medium text-gray-100 uppercase tracking-wider"
                    >
                      Area
                    </th>
                    <th
                      class="px-4 py-3 text-left text-xs font-medium text-gray-100 uppercase tracking-wider"
                    >
                      Pincode
                    </th>
                    <th
                      class="px-4 py-3 text-left text-xs font-medium text-gray-100 uppercase tracking-wider"
                    >
                      Street
                    </th>
                    <!-- Add a new header for checkbox -->
                    <th
                      class="px-4 py-3 text-left text-xs font-medium text-gray-100 uppercase tracking-wider"
                    >
                      Active
                    </th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-gray-200">
                  <% employees.forEach((employee, index) => { %>
                  <tr
                    class="<%= index % 2 === 0 ? 'bg-gray-50' : 'bg-white' %> hover:bg-gray-100"
                  >
                    <td
                      class="px-4 py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      <%= employee.id %>
                    </td>
                    <td
                      class="px-4 py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      <%= employee.firstName %>
                    </td>
                    <td
                      class="px-4 py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      <%= employee.lastName %>
                    </td>
                    <td
                      class="px-4 py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      <%= employee.email %>
                    </td>
                    <td
                      class="px-4 py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      <%= employee.phoneNumber %>
                    </td>
                    <td
                      class="px-4 py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      <%= employee.city %>
                    </td>
                    <td
                      class="px-4 py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      <%= employee.area %>
                    </td>
                    <td
                      class="px-4 py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      <%= employee.pincode %>
                    </td>
                    <td
                      class="px-4 py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      <%= employee.streetAddress %>
                    </td>
                    <!-- Checkbox for Active Status -->
                    <td
                      class="px-4 py-4 whitespace-nowrap text-sm text-gray-900"
                    >
                      <input
                        type="checkbox"
                        id="active_<%= employee.id %>"
                        data-employee-id="<%= employee.id %>"
                        <%
                        if
                        (employee.status)
                        {
                        %>
                      checked <% } %>>
                    </td>
                  </tr>
                  <% }); %>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Footer -->
    <%- include("./partial/footer") %>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>

    <script>
      $(document).ready(function () {
        // DataTable initialization
        $("#employeeTable").DataTable({
          pagingType: "full",
        });

        // Checkbox change event handler
        $(document).on("change", "input[type='checkbox']", function () {
          const employeeId = $(this).data("employee-id");
          const isActive = this.checked;
          // Call API to update employee's active status
          $.ajax({
            url: `/admin/employees/${employeeId}/status`,
            method: "PUT",
            contentType: "application/json",
            data: JSON.stringify({ status: isActive }),
            success: function (response) {
              // Show SweetAlert toast notification
              Swal.fire({
                icon: "success",
                title: "Success",
                text: "status updated successfully",
                toast: true,
                position: "top-end",
                showConfirmButton: false,
                timer: 3000,
              });
            },
            error: function (error) {
              console.error("Error updating employee status:", error);
              // Show SweetAlert toast notification for error
              Swal.fire({
                icon: "error",
                title: "Error",
                text: "Error updating employee status",
                toast: true,
                position: "top-end",
                showConfirmButton: false,
                timer: 3000,
              });
            },
          });
        });
      });
    </script>
  </body>
</html>
