  <!DOCTYPE html>
  <html lang="en">
    <head>
      <%- include("../partial/head", { title: "Create Quiz" }) %>
      <link
        href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
        rel="stylesheet"
      />
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    </head>
    <body>
      <!-- Sidebar -->
      <%- include("../partial/sidebar") %>

      <!-- Main Content -->
      <div class="ml-0 md:ml-64 flex flex-col min-h-screen">
        <!-- Header -->
        <%- include("../partial/header") %>

        <!-- Main Content Area -->
        <div class="container mx-auto py-8 mt-5">
          <div class="flex flex-col shadow-md mb-5 bg-white rounded-lg p-5">
            <h1 class="text-4xl font-extrabold mb-4 text-gray-900">
              Create Quiz
            </h1>

            <form action="/admin/quiz/create" method="POST">
              <div class="mb-4">
                <label for="jobId" class="block text-sm font-medium text-gray-700"
                  >Job</label
                >
                <select
                  id="jobId"
                  name="jobId"
                  class="mt-1 block w-full border-gray-300 rounded-md shadow-sm"
                >
                  <!-- Populate this with job options -->
                  <% jobs.forEach(job => { %>
                  <option value="<%= job.id %>"><%= job.jobTitle %></option>
                  <% }) %>
                </select>
              </div>

              <div class="mb-4">
                <label
                  for="questionType"
                  class="block text-sm font-medium text-gray-700"
                  >Question Type</label
                >
                <select
                  id="questionType"
                  name="questionType"
                  class="mt-1 block w-full border-gray-300 rounded-md shadow-sm"
                >
                  <option value="single">Single Choice</option>
                  <option value="multiple">Multiple Choice</option>
                </select>
              </div>

              <div id="questionsContainer">
                <!-- Dynamic question fields will be appended here -->
              </div>

              <button
                type="submit"
                class="inline-flex items-end px-4 py-2 bg-blue-500 border border-transparent rounded-md shadow-sm text-base font-medium text-white hover:bg-blue-600"
              >
                Create Quiz
              </button>
            </form>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <%- include("../partial/footer") %>

      <script>
        $(document).ready(function () {
          function renderQuestionFields(type) {
            $("#questionsContainer").html(""); // Clear existing fields

            // Create question input
            $("#questionsContainer").append(`
              <div class="mb-4">
                <label for="question" class="block text-sm font-medium text-gray-700">Question</label>
                <input id="question" name="question" type="text" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" />
              </div>
            `);

            // Create options fields
            $("#questionsContainer").append(`
              <div id="optionsContainer" class="mb-4">
                <label class="block text-sm font-medium text-gray-700">Options</label>
                <div id="optionsList"></div>
                <button type="button" id="addOption" class="mt-2 inline-flex items-center px-4 py-2 bg-gray-300 border border-transparent rounded-md shadow-sm text-base font-medium text-gray-800 hover:bg-gray-400">Add Option</button>
              </div>
            `);

            if (type === "multiple") {
              $("#optionsList").append(createOptionField("multiple", 1));
            } else {
              $("#optionsList").append(createOptionField("single", 1));
            }

            // Add more options dynamically
            $("#addOption").on("click", function () {
              let currentOptions = $("#optionsList .option-field").length;

              if (currentOptions < 4) {
                const optionField =
                  type === "multiple"
                    ? createOptionField("multiple", currentOptions + 1)
                    : createOptionField("single", currentOptions + 1);

                $("#optionsList").append(optionField);

                // Disable button if options reach limit
                if (currentOptions + 1 >= 4) {
                  $(this)
                    .prop("disabled", true)
                    .addClass("cursor-not-allowed opacity-50");
                }
              }cv
            });

            // Listen for remove button click
            $("#optionsList").on("click", ".removeOption", function () {
              $(this).closest(".option-field").remove();

              // Enable "Add Option" button if options are less than 4
              if ($("#optionsList .option-field").length < 4) {
                $("#addOption")
                  .prop("disabled", false)
                  .removeClass("cursor-not-allowed opacity-50");
              }

              // Hide "Remove" button if there is only one option left
              toggleRemoveButton();
            });

            // Initial hide/remove button adjustment
            toggleRemoveButton();
          }

          function createOptionField(type, optionNumber) {
            const inputType = type === "multiple" ? "checkbox" : "radio";
            return `
              <div class="mb-2 option-field flex items-center">
                <input type="${inputType}" name="options" value="Option${optionNumber}" />
                <input type="text" name="optionText" class="ml-2 border-gray-300 rounded-md shadow-sm" placeholder="Option Text" />
                <button type="button" class="removeOption ml-2 inline-flex items-center px-2 py-1 bg-red-500 text-white rounded-md hover:bg-red-600">
                  Remove
                </button>
              </div>
            `;
          }

          function toggleRemoveButton() {
            $("#optionsList .option-field").each(function (index) {
              $(this)
                .find(".removeOption")
                .toggle($("#optionsList .option-field").length > 1);
            });
          }

          // Initialize question fields based on default type
          renderQuestionFields($("#questionType").val());

          // Update question fields when type changes
          $("#questionType").on("change", function () {
            renderQuestionFields($(this).val());
          });
        });
      </script>
    </body>
  </html>
